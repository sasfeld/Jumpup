<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBsZwdJI29OQJgyUNPbucRH_l5r_NqSuH4&sensor=false"></script>
    <script>
var elevator;
var map;
var geocoder;
var infowindow = new google.maps.InfoWindow();
var berlin = new google.maps.LatLng(52.31, 13.24);


function initialize() {
  var mapOptions = {
    zoom: 8,
    center: berlin,
    mapTypeId: 'terrain'
  }
  map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

  // Create an ElevationService
  elevator = new google.maps.ElevationService();
  
  geocoder = new google.maps.Geocoder();

  // Add a listener for the click event and call getElevation on that location
  google.maps.event.addListener(map, 'click', addMarker);
}

/**
 * Add a marker on the map. 
 * @param event the 
 */
function addMarker(event) {
	var latLngClick = event.latLng;
	

	  var markerContent = '<p><b>Mr. Salesman is travelling...</b></p>';

	  var markerWindow = new google.maps.InfoWindow({
	      content: markerContent
	  });

	  var marker = new google.maps.Marker({
	      position: latLngClick,
	      map: map,
	      title: 'My first marker...',
	      animation: google.maps.Animation.BOUNCE, 
	      icon: "http://www.kneller-gifs.de/bilder/m/menschen_einzelnd18.gif", 
	      optimized: false,
	      draggable: true,
	      crossOnDrag: false,
	  });
	  
	  google.maps.event.addListener(marker, 'click', function() {
	    markerWindow.open(map,marker);
	  });
	  
	  /**
	  * EventListener for the end of the user's dragging.
	  * Google's DirectionService will be called for the adress belonging to the LatLng value.
	  */
	  google.maps.event.addListener(marker, 'dragend', function(event) {   	    
	    geocoder.geocode({'latLng': event.latLng}, function(results, status) {	   
	        if (status == google.maps.GeocoderStatus.OK) {
	          if (results[1]) {		        	
	        	  markerWindow.setContent(markerContent + "<p>"+ results[1].formatted_address +" </p>");
	        	  markerWindow.open(map, marker);
	          } else {
	            alert('No results found');
	          }
	        } else {
	          alert('Geocoder failed due to: ' + status);
	        }
	      });
	  });
	  
	  
	
}

 


// google.maps.event.addDomListener(window, 'load', initialize);

    </script>
  </head>
 <body onload="initialize()">
    <div id="map-canvas" style="float:left;width:800px;height:800px;"></div>
  </body>
</html>
